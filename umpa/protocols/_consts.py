#!/usr/bin/env python
# -*- coding: utf-8 -*-

# Copyright (C) 2008 Adriano Monteiro Marques.
#
# Author: Bartosz SKOWRON <getxsick at gmail dot com>
#
# This library is free software; you can redistribute it and/or modify 
# it under the terms of the GNU Lesser General Public License as published 
# by the Free Software Foundation; either version 2.1 of the License, or 
# (at your option) any later version.
#
# This library is distributed in the hope that it will be useful, but 
# WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
# or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public 
# License for more details.
#
# You should have received a copy of the GNU Lesser General Public License 
# along with this library; if not, write to the Free Software Foundation, 
# Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA 

BYTE = 8

# Ether types (based on IEEE 802.1Q)
ETHERTYPE_ARP = 0x0806
ETHERTYPE_RARP = 0x8035
ETHERTYPE_IP = 0x0800
ETHERTYPE_IPV6 = 0x86DD
ETHERTYPE_PPPOE = 0x8863

# IP Versions (based on RFC 790 "Assigned Numbers")
IPVERSION_RESERVED0 = 0
IPVERSION_4 = 4
IPVERSION_ST_DATAGRAM_MODE = 5
IPVERSION_6 = 6
IPVERSION_RESERVED15 = 15

# Protocol Numbers (based on RFC 790 "Assigned Numbers")
PROTOCOL_RESERVED0 = 0
PROTOCOL_ICMP = 1
PROTOCOL_GATEWAY_TO_GATEWAY = 3
PROTOCOL_CMCC = 4
PROTOCOL_ST = 5
PROTOCOL_TCP = 6
PROTOCOL_UCL = 7
PROTOCOL_SECURE = 9
PROTOCOL_BBN_RCC_MONITORING = 10
PROTOCOL_NVP = 11
PROTOCOL_PUP = 12
PROTOCOL_PLURIBUS = 13
PROTOCOL_TELENET = 14
PROTOCOL_XNET = 15
PROTOCOL_CHAOS = 16
PROTOCOL_UDP = 17
PROTOCOL_MULTIPLEXING = 18
PROTOCOL_DCN = 19
PROTOCOL_TAC_MONITORING = 20
PROTOCOL_ANY = 63
PROTOCOL_SATNET_BACKROOM_EXPAK = 64
PROTOCOL_MIT_SUBNET_SUPPORT = 65
PROTOCOL_SATNET_MONITORING = 69
PROTOCOL_INTERNET_PACKET_CORE_UTILITY = 71
PROTOCOL_BACKROOM_SATNET_MONITORING = 76
PROTOCOL_WIDEBAND_MONITORING = 78
PROTOCOL_WIDEBAND_EXPAK = 79
PROTOCOL_RESERVED255 = 255

# TTL initial values
# based on http://secfr.nerim.net/docs/fingerprint/en/ttl_default.html
TTL_AIX = 60
TTL_DEC = 30
TTL_FREEBSD = 64
TTL_HPUX = 64
TTL_IRIX = 60
TTL_LINUX = 64
TTL_MACOS = 60
TTL_OS2 = 64
TTL_SOLARIS = 255
TTL_SUNOS = 60
TTL_ULTRIX = 60
TTL_WINDOWS = 128

# PORT names
# based on /etc/services
# TCP
PORT_TCP_TCPMUX = 1
PORT_TCP_ECHO = 7
PORT_TCP_DISCARD = 9
PORT_TCP_SYSTAT = 11
PORT_TCP_DAYTIME = 13
PORT_TCP_NETSTAT = 15
PORT_TCP_QOTD = 17
PORT_TCP_MSP = 18
PORT_TCP_CHARGEN = 19
PORT_TCP_DATA = 20
PORT_TCP_FTP = 21
PORT_TCP_SSH = 22
PORT_TCP_TELNET = 23
PORT_TCP_SMTP = 25
PORT_TCP_TIME = 37
PORT_TCP_NAMESERVER = 42
PORT_TCP_WHOIS = 43
PORT_TCP_TACACS = 49
PORT_TCP_CK = 50
PORT_TCP_DOMAIN = 53
PORT_TCP_MTP = 57
PORT_TCP_DS = 65
PORT_TCP_BOOTPS = 67
PORT_TCP_BOOTPC = 68
PORT_TCP_GOPHER = 70
PORT_TCP_RJE = 77
PORT_TCP_FINGER = 79
PORT_TCP_WWW = 80
PORT_TCP_LINK = 87
PORT_TCP_KERBEROS = 88
PORT_TCP_SUPDUP = 95
PORT_TCP_HOSTNAMES = 101
PORT_TCP_TSAP = 102
PORT_TCP_NEMA = 104
PORT_TCP_NS = 105
PORT_TCP_RTELNET = 107
PORT_TCP_POP2 = 109
PORT_TCP_POP3 = 110
PORT_TCP_SUNRPC = 111
PORT_TCP_AUTH = 113
PORT_TCP_SFTP = 115
PORT_TCP_PATH = 117
PORT_TCP_NNTP = 119
PORT_TCP_NTP = 123
PORT_TCP_PWDGEN = 129
PORT_TCP_SRV = 135
PORT_TCP_NS = 137
PORT_TCP_DGM = 138
PORT_TCP_SSN = 139
PORT_TCP_IMAP2 = 143
PORT_TCP_SNMP = 161
PORT_TCP_TRAP = 162
PORT_TCP_MAN = 163
PORT_TCP_AGENT = 164
PORT_TCP_MAILQ = 174
PORT_TCP_XDMCP = 177
PORT_TCP_NEXTSTEP = 178
PORT_TCP_BGP = 179
PORT_TCP_PROSPERO = 191
PORT_TCP_IRC = 194
PORT_TCP_SMUX = 199
PORT_TCP_RTMP = 201
PORT_TCP_NBP = 202
PORT_TCP_ECHO = 204
PORT_TCP_ZIS = 206
PORT_TCP_QMTP = 209
PORT_TCP_Z3950 = 210
PORT_TCP_IPX = 213
PORT_TCP_IMAP3 = 220
PORT_TCP_PAWSERV = 345
PORT_TCP_ZSERV = 346
PORT_TCP_FATSERV = 347
PORT_TCP_RPC2PORTMAP = 369
PORT_TCP_CODAAUTH2 = 370
PORT_TCP_CLEARCASE = 371
PORT_TCP_ULISTSERV = 372
PORT_TCP_LDAP = 389
PORT_TCP_IMSP = 406
PORT_TCP_HTTPS = 443
PORT_TCP_SNPP = 444
PORT_TCP_DS = 445
PORT_TCP_KPASSWD = 464
PORT_TCP_SAFT = 487
PORT_TCP_ISAKMP = 500
PORT_TCP_RTSP = 554
PORT_TCP_NQS = 607
PORT_TCP_LOCAL = 610
PORT_TCP_GUI = 611
PORT_TCP_IND = 612
PORT_TCP_IPP = 631
PORT_TCP_EXEC = 512
PORT_TCP_LOGIN = 513
PORT_TCP_SHELL = 514
PORT_TCP_PRINTER = 515
PORT_TCP_TEMPO = 526
PORT_TCP_COURIER = 530
PORT_TCP_CONFERENCE = 531
PORT_TCP_NETNEWS = 532
PORT_TCP_GDOMAP = 538
PORT_TCP_UUCP = 540
PORT_TCP_KLOGIN = 543
PORT_TCP_KSHELL = 544
PORT_TCP_AFPOVERTCP = 548
PORT_TCP_REMOTEFS = 556
PORT_TCP_NNTPS = 563
PORT_TCP_SUBMISSION = 587
PORT_TCP_LDAPS = 636
PORT_TCP_TINC = 655
PORT_TCP_SILC = 706
PORT_TCP_ADM = 749
PORT_TCP_WEBSTER = 765
PORT_TCP_RSYNC = 873
PORT_TCP_DATA = 989
PORT_TCP_FTPS = 990
PORT_TCP_TELNETS = 992
PORT_TCP_IMAPS = 993
PORT_TCP_IRCS = 994
PORT_TCP_POP3S = 995
PORT_TCP_SOCKS = 1080
PORT_TCP_PROOFD = 1093
PORT_TCP_ROOTD = 1094
PORT_TCP_OPENVPN = 1194
PORT_TCP_RMIREGISTRY = 1099
PORT_TCP_KAZAA = 1214
PORT_TCP_NESSUS = 1241
PORT_TCP_LOTUSNOTE = 1352
PORT_TCP_S = 1433
PORT_TCP_M = 1434
PORT_TCP_INGRESLOCK = 1524
PORT_TCP_NP = 1525
PORT_TCP_DATAMETRICS = 1645
PORT_TCP_PORT = 1646
PORT_TCP_KERMIT = 1649
PORT_TCP_L2F = 1701
PORT_TCP_RADIUS = 1812
PORT_TCP_ACCT = 1813
PORT_TCP_MSNP = 1863
PORT_TCP_STATUS = 1957
PORT_TCP_SERVER = 1958
PORT_TCP_REMOTEPING = 1959
PORT_TCP_NFS = 2049
PORT_TCP_SC104 = 2101
PORT_TCP_CVSPSERVER = 2401
PORT_TCP_VENUS = 2430
PORT_TCP_SE = 2431
PORT_TCP_CODASRV = 2432
PORT_TCP_SE = 2433
PORT_TCP_MON = 2583
PORT_TCP_DICT = 2628
PORT_TCP_GPSD = 2947
PORT_TCP_GDS_DB = 3050
PORT_TCP_ICPV2 = 3130
PORT_TCP_MYSQL = 3306
PORT_TCP_NUT = 3493
PORT_TCP_DISTCC = 3632
PORT_TCP_DAAP = 3689
PORT_TCP_SVN = 3690
PORT_TCP_SUUCP = 4013
PORT_TCP_SYSRQD = 4094
PORT_TCP_IAX = 4569
PORT_TCP_PORT = 4899
PORT_TCP_RFE = 5002
PORT_TCP_MMCC = 5050
PORT_TCP_SIP = 5060
PORT_TCP_TLS = 5061
PORT_TCP_AOL = 5190
PORT_TCP_CLIENT = 5222
PORT_TCP_SERVER = 5269
PORT_TCP_CFENGINE = 5308
PORT_TCP_MDNS = 5353
PORT_TCP_POSTGRESQL = 5432
PORT_TCP_GGZ = 5688
PORT_TCP_X11 = 6000
PORT_TCP_1 = 6001
PORT_TCP_2 = 6002
PORT_TCP_3 = 6003
PORT_TCP_4 = 6004
PORT_TCP_5 = 6005
PORT_TCP_6 = 6006
PORT_TCP_7 = 6007
PORT_TCP_SVC = 6346
PORT_TCP_RTR = 6347
PORT_TCP_SGE_QMASTER = 6444
PORT_TCP_SGE_EXECD = 6445
PORT_TCP_FILESERVER = 7000
PORT_TCP_CALLBACK = 7001
PORT_TCP_PRSERVER = 7002
PORT_TCP_VLSERVER = 7003
PORT_TCP_KASERVER = 7004
PORT_TCP_VOLSER = 7005
PORT_TCP_ERRORS = 7006
PORT_TCP_BOS = 7007
PORT_TCP_UPDATE = 7008
PORT_TCP_RMTSYS = 7009
PORT_TCP_SERVICE = 7100
PORT_TCP_DIR = 9101
PORT_TCP_FD = 9102
PORT_TCP_SD = 9103
PORT_TCP_AMANDA = 10080
PORT_TCP_HKP = 11371
PORT_TCP_BPRD = 13720
PORT_TCP_BPDBM = 13721
PORT_TCP_MSVC = 13722
PORT_TCP_VNETD = 13724
PORT_TCP_BPCD = 13782
PORT_TCP_VOPIED = 13783
PORT_TCP_WNN6 = 22273
PORT_TCP_KERBEROS4 = 750
PORT_TCP_KERBEROS_MASTER = 751
PORT_TCP_KRB_PROP = 754
PORT_TCP_KRBUPDATE = 760
PORT_TCP_SWAT = 901
PORT_TCP_KPOP = 1109
PORT_TCP_KNETD = 2053
PORT_TCP_EKLOGIN = 2105
PORT_TCP_KX = 2111
PORT_TCP_IPROP = 2121
PORT_TCP_SUPFILESRV = 871
PORT_TCP_SUPFILEDBG = 1127
PORT_TCP_LINUXCONF = 98
PORT_TCP_POPPASSD = 106
PORT_TCP_SSMTP = 465
PORT_TCP_MOIRA_DB = 775
PORT_TCP_MOIRA_UPDATE = 777
PORT_TCP_SPAMD = 783
PORT_TCP_OMIRR = 808
PORT_TCP_CUSTOMS = 1001
PORT_TCP_SKKSERV = 1178
PORT_TCP_RMTCFG = 1236
PORT_TCP_WIPLD = 1300
PORT_TCP_XTEL = 1313
PORT_TCP_XTELW = 1314
PORT_TCP_SUPPORT = 1529
PORT_TCP_SIEVE = 2000
PORT_TCP_CFINGER = 2003
PORT_TCP_NDTP = 2010
PORT_TCP_FROX = 2121
PORT_TCP_NINSTALL = 2150
PORT_TCP_ZEBRASRV = 2600
PORT_TCP_ZEBRA = 2601
PORT_TCP_RIPD = 2602
PORT_TCP_RIPNGD = 2603
PORT_TCP_OSPFD = 2604
PORT_TCP_BGPD = 2605
PORT_TCP_OSPF6D = 2606
PORT_TCP_OSPFAPI = 2607
PORT_TCP_ISISD = 2608
PORT_TCP_AFBACKUP = 2988
PORT_TCP_AFMBACKUP = 2989
PORT_TCP_XTELL = 4224
PORT_TCP_FAX = 4557
PORT_TCP_HYLAFAX = 4559
PORT_TCP_DISTMP3 = 4600
PORT_TCP_MUNIN = 4949
PORT_TCP_CSTATD = 5051
PORT_TCP_SSTATD = 5052
PORT_TCP_PCRD = 5151
PORT_TCP_NOCLOG = 5354
PORT_TCP_HOSTMON = 5355
PORT_TCP_RPLAY = 5555
PORT_TCP_RPTP = 5556
PORT_TCP_NSCA = 5667
PORT_TCP_MRTD = 5674
PORT_TCP_BGPSIM = 5675
PORT_TCP_CANNA = 5680
PORT_TCP_PORT = 6566
PORT_TCP_IRCD = 6667
PORT_TCP_FTP = 8021
PORT_TCP_WEBCACHE = 8080
PORT_TCP_TPROXY = 8081
PORT_TCP_OMNIORB = 8088
PORT_TCP_DAEMON = 8990
PORT_TCP_XINETD = 9098
PORT_TCP_GIT = 9418
PORT_TCP_ZOPE = 9673
PORT_TCP_WEBMIN = 10000
PORT_TCP_KAMANDA = 10081
PORT_TCP_AMANDAIDX = 10082
PORT_TCP_AMIDXTAPE = 10083
PORT_TCP_SMSQP = 11201
PORT_TCP_XPILOT = 15345
PORT_TCP_CAD = 17004
PORT_TCP_ISDNLOG = 20011
PORT_TCP_VBOXD = 20012
PORT_TCP_BINKP = 24554
PORT_TCP_ASP = 27374
PORT_TCP_CSYNC2 = 30865
PORT_TCP_DIRCPROXY = 57000
PORT_TCP_TFIDO = 60177
PORT_TCP_FIDO = 60179
# UDP
PORT_UDP_ECHO = 7
PORT_UDP_DISCARD = 9
PORT_UDP_DAYTIME = 13
PORT_UDP_MSP = 18
PORT_UDP_CHARGEN = 19
PORT_UDP_FSP = 21
PORT_UDP_SSH = 22
PORT_UDP_TIME = 37
PORT_UDP_RLP = 39
PORT_UDP_TACACS = 49
PORT_UDP_CK = 50
PORT_UDP_DOMAIN = 53
PORT_UDP_DS = 65
PORT_UDP_BOOTPS = 67
PORT_UDP_BOOTPC = 68
PORT_UDP_TFTP = 69
PORT_UDP_GOPHER = 70
PORT_UDP_WWW = 80
PORT_UDP_KERBEROS = 88
PORT_UDP_NEMA = 104
PORT_UDP_NS = 105
PORT_UDP_RTELNET = 107
PORT_UDP_POP2 = 109
PORT_UDP_POP3 = 110
PORT_UDP_SUNRPC = 111
PORT_UDP_NTP = 123
PORT_UDP_PWDGEN = 129
PORT_UDP_SRV = 135
PORT_UDP_NS = 137
PORT_UDP_DGM = 138
PORT_UDP_SSN = 139
PORT_UDP_IMAP2 = 143
PORT_UDP_SNMP = 161
PORT_UDP_TRAP = 162
PORT_UDP_MAN = 163
PORT_UDP_AGENT = 164
PORT_UDP_MAILQ = 174
PORT_UDP_XDMCP = 177
PORT_UDP_NEXTSTEP = 178
PORT_UDP_BGP = 179
PORT_UDP_PROSPERO = 191
PORT_UDP_IRC = 194
PORT_UDP_SMUX = 199
PORT_UDP_RTMP = 201
PORT_UDP_NBP = 202
PORT_UDP_ECHO = 204
PORT_UDP_ZIS = 206
PORT_UDP_QMTP = 209
PORT_UDP_Z3950 = 210
PORT_UDP_IPX = 213
PORT_UDP_IMAP3 = 220
PORT_UDP_PAWSERV = 345
PORT_UDP_ZSERV = 346
PORT_UDP_FATSERV = 347
PORT_UDP_RPC2PORTMAP = 369
PORT_UDP_CODAAUTH2 = 370
PORT_UDP_CLEARCASE = 371
PORT_UDP_ULISTSERV = 372
PORT_UDP_LDAP = 389
PORT_UDP_IMSP = 406
PORT_UDP_HTTPS = 443
PORT_UDP_SNPP = 444
PORT_UDP_DS = 445
PORT_UDP_KPASSWD = 464
PORT_UDP_SAFT = 487
PORT_UDP_ISAKMP = 500
PORT_UDP_RTSP = 554
PORT_UDP_NQS = 607
PORT_UDP_LOCAL = 610
PORT_UDP_GUI = 611
PORT_UDP_IND = 612
PORT_UDP_IPP = 631
PORT_UDP_BIFF = 512
PORT_UDP_WHO = 513
PORT_UDP_SYSLOG = 514
PORT_UDP_TALK = 517
PORT_UDP_NTALK = 518
PORT_UDP_ROUTE = 520
PORT_UDP_TIMED = 525
PORT_UDP_NETWALL = 533
PORT_UDP_GDOMAP = 538
PORT_UDP_AFPOVERTCP = 548
PORT_UDP_NNTPS = 563
PORT_UDP_SUBMISSION = 587
PORT_UDP_LDAPS = 636
PORT_UDP_TINC = 655
PORT_UDP_SILC = 706
PORT_UDP_WEBSTER = 765
PORT_UDP_RSYNC = 873
PORT_UDP_TELNETS = 992
PORT_UDP_IMAPS = 993
PORT_UDP_IRCS = 994
PORT_UDP_POP3S = 995
PORT_UDP_SOCKS = 1080
PORT_UDP_PROOFD = 1093
PORT_UDP_ROOTD = 1094
PORT_UDP_OPENVPN = 1194
PORT_UDP_RMIREGISTRY = 1099
PORT_UDP_KAZAA = 1214
PORT_UDP_NESSUS = 1241
PORT_UDP_LOTUSNOTE = 1352
PORT_UDP_S = 1433
PORT_UDP_M = 1434
PORT_UDP_INGRESLOCK = 1524
PORT_UDP_NP = 1525
PORT_UDP_DATAMETRICS = 1645
PORT_UDP_PORT = 1646
PORT_UDP_KERMIT = 1649
PORT_UDP_L2F = 1701
PORT_UDP_RADIUS = 1812
PORT_UDP_ACCT = 1813
PORT_UDP_MSNP = 1863
PORT_UDP_NFS = 2049
PORT_UDP_SC104 = 2101
PORT_UDP_CVSPSERVER = 2401
PORT_UDP_VENUS = 2430
PORT_UDP_SE = 2431
PORT_UDP_CODASRV = 2432
PORT_UDP_SE = 2433
PORT_UDP_MON = 2583
PORT_UDP_DICT = 2628
PORT_UDP_GPSD = 2947
PORT_UDP_GDS_DB = 3050
PORT_UDP_ICPV2 = 3130
PORT_UDP_MYSQL = 3306
PORT_UDP_NUT = 3493
PORT_UDP_DISTCC = 3632
PORT_UDP_DAAP = 3689
PORT_UDP_SVN = 3690
PORT_UDP_SUUCP = 4013
PORT_UDP_SYSRQD = 4094
PORT_UDP_IAX = 4569
PORT_UDP_PORT = 4899
PORT_UDP_RFE = 5002
PORT_UDP_MMCC = 5050
PORT_UDP_SIP = 5060
PORT_UDP_TLS = 5061
PORT_UDP_AOL = 5190
PORT_UDP_CLIENT = 5222
PORT_UDP_SERVER = 5269
PORT_UDP_CFENGINE = 5308
PORT_UDP_MDNS = 5353
PORT_UDP_POSTGRESQL = 5432
PORT_UDP_GGZ = 5688
PORT_UDP_X11 = 6000
PORT_UDP_1 = 6001
PORT_UDP_2 = 6002
PORT_UDP_3 = 6003
PORT_UDP_4 = 6004
PORT_UDP_5 = 6005
PORT_UDP_6 = 6006
PORT_UDP_7 = 6007
PORT_UDP_SVC = 6346
PORT_UDP_RTR = 6347
PORT_UDP_SGE_QMASTER = 6444
PORT_UDP_SGE_EXECD = 6445
PORT_UDP_FILESERVER = 7000
PORT_UDP_CALLBACK = 7001
PORT_UDP_PRSERVER = 7002
PORT_UDP_VLSERVER = 7003
PORT_UDP_KASERVER = 7004
PORT_UDP_VOLSER = 7005
PORT_UDP_ERRORS = 7006
PORT_UDP_BOS = 7007
PORT_UDP_UPDATE = 7008
PORT_UDP_RMTSYS = 7009
PORT_UDP_SERVICE = 7100
PORT_UDP_DIR = 9101
PORT_UDP_FD = 9102
PORT_UDP_SD = 9103
PORT_UDP_AMANDA = 10080
PORT_UDP_HKP = 11371
PORT_UDP_BPRD = 13720
PORT_UDP_BPDBM = 13721
PORT_UDP_MSVC = 13722
PORT_UDP_VNETD = 13724
PORT_UDP_BPCD = 13782
PORT_UDP_VOPIED = 13783
PORT_UDP_WNN6 = 22273
PORT_UDP_KERBEROS4 = 750
PORT_UDP_KERBEROS_MASTER = 751
PORT_UDP_PASSWD_SERVER = 752
PORT_UDP_SRV = 2102
PORT_UDP_CLT = 2103
PORT_UDP_HM = 2104
PORT_UDP_POPPASSD = 106
PORT_UDP_MOIRA_UREG = 779
PORT_UDP_OMIRR = 808
PORT_UDP_CUSTOMS = 1001
PORT_UDP_PREDICT = 1210
PORT_UDP_NINSTALL = 2150
PORT_UDP_AFBACKUP = 2988
PORT_UDP_AFMBACKUP = 2989
PORT_UDP_NOCLOG = 5354
PORT_UDP_HOSTMON = 5355
PORT_UDP_RPLAY = 5555
PORT_UDP_RPTP = 5556
PORT_UDP_OMNIORB = 8088
PORT_UDP_MANDELSPAWN = 9359
PORT_UDP_KAMANDA = 10081
PORT_UDP_SMSQP = 11201
PORT_UDP_XPILOT = 15345
PORT_UDP_CMSD = 17001
PORT_UDP_CRSD = 17002
PORT_UDP_GCD = 17003
PORT_UDP_ISDNLOG = 20011
PORT_UDP_VBOXD = 20012
PORT_UDP_ASP = 27374
